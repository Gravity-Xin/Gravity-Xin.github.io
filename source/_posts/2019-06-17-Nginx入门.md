---
title: Nginx入门
date: 2019-06-17 17:24:19
categories: 
- 系统架构
tags: 
- Nginx
---

## 常用Web服务器

- Tomcat, Jetty: 面向Java语言的重量级Web服务器，性能与Nginx没有可比性
- IIS: 只能在Windows操作系统上运行的Web服务器
- Apache: 重量级的、不支持高并发的Web服务器
- Lighttpd: 轻量级、高性能Web服务器
- Nginx: 轻量级、高性能Web服务器
  - 静态资源代理
  - API服务
    - OpenResty
  - 反向代理
    - 缓存加速
    - 负载均衡

## Nginx的特点

- 高性能: 单次请求响应更快、高并发下性能更好
- 高扩展性: 包含多个不同功能、不同层次、不同类型且耦合度低的模块，来自于官方或者第三方
- 高可靠: Master-Worker架构，Worker进程间相对独立；当单个Worker进程出错时，Master进程可以创建新的Worker进程
- 低内存: 单个HTTP连接占用的内存更小，这可是高性能的基础
- 单机支持10W以上的连接: 单机支持的连接数与系统内存大小有关
- 热部署: Master-Worker架构下，可以在不间断服务的情况下升级Nginx可执行文件

## Nginx的编译与配置

### 编译

```shell
# 检测系统环境和外部依赖，解析编译参数，生成C源码文件、Makefile文件等
./configure
# 对C源码文件进行编译，生成二进制文件
make
# 将二进制文件、配置文件等安装到指定目录
make install
```

### 命令行参数

默认情况下，Nginx被安装在`/usr/local/nginx/sbin`目录下，使用`/usr/local/nginx/conf/nginx.conf`配置文件

- 无参数直接启动 : 使用默认路径下的配置文件
- `-c filename`: 指定配置文件
- `-p prefix`: 指定Nginx的安装目录
- `-g directives`: 设置全局配置参数
- `-t`: 测试配置文件是否有效，然后退出
- `-v`: 显示Nginx版本，然后退出
- `-V`: 显示Nginx版本和编译参数，然后退出
- `-s signal`: 向Master进程发送命令，本质是通过向Master或Worker进程发送不同的信号来实现的
  - `stop`: 强制停止Nginx服务
  - `quit`: 优雅停止Nginx服务，此时Nginx服务会在处理完当前所有请求之后再停止服务
  - `reload`: 通知Nginx服务重新加载nginx.conf配置文件
  - `stop`: 通知Nginx服务重新打开日志文件，这样便可以将当前日志文件改名或转移备份

### 基本配置